<div class="header">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-12">
        <div class="header-wrap">
          <div id="logo" class="logo">
            <a href="<%= root_path %>" title="">
              openspace
            </a>
          </div><!-- /.logo -->
          <div class="nav-wrap">
            <nav id="mainnav" class="mainnav">
              <ul class="menu">
                <li>
                  <a href="/spaces" title="">Explore</a>
                </li>
                <% if user_signed_in? %>
                <% if host_route? %>
                <li>
                  <%= link_to 'Bookings', host_bookings_path %>
                </li>
                <li>
                  <%= link_to 'My Spaces', host_spaces_path %>
                </li>
                <% else %>
                <li>
                  <%= link_to 'Trips', bookings_path %>
                </li>
                <li>
                  <%= link_to 'Favorites', favorites_path %>
                </li>
                <li>
                  <%= link_to 'Messages', conversations_path, id: 'conversation-button' %>
                  <ul class="submenu">
                    <% current_user.conversations.each do |conversation| %>
                    <li>
                      <%= link_to conversation_path(conversation) do %>
                      <%= conversation.last_message(current_user).try(:content) %>
                      -
                      <%= conversation.partner(current_user).try(:full_name) %>
                      <% end %>
                    </li>
                    <% end %>
                  </ul>
                </li>
                <% end %>
                <li>
                  <%= link_to "Host", host_bookings_path %>
                  <ul class="submenu">
                    <% if current_user.is_host? %>
                    <li>
                      <%= link_to "Bookings", host_bookings_path %>
                    </li>
                    <li>
                      <%= link_to "My Spaces", host_spaces_path %>
                    </li>
                    <% end %>
                    <li>
                      <%= link_to "Log out", destroy_user_session_path, method: :delete %>
                    </li>
                  </ul>
                </li>
                <% else %>
                <li>
                  <%= link_to 'Log in', new_user_session_path %>
                </li>
                <% end %>
              </ul>
            </nav><!-- /.mainnav -->
            <div class="button-header" id="button-add-navbar">
              <%= link_to new_space_path do %>
              <i class="ti-plus"></i>
              Add Your Space
              <% end %>
            </div>
            <div class="show-search">
                <button><span class="ti-search"></span></button>
              <div class="submenu top-search search-header">
                <%= simple_form_for :search, url: spaces_path, html: { method: 'get'} do |f| %>
                  <%= f.input :event_type, label: false, prompt: 'What are you planning?',collection: Property.activity_types, label_method: :content, value_method: :id , input_html: {class: 'property', style: "background: white;"}%>
                <%= f.submit value: "Go!", id: 'white-btn' %>
                <% end %>
              </div>
            </div>
            <div class="btn-menu" id="responsive-menu-button">
              <span></span>
            </div><!-- //mobile menu button -->
          </div><!-- /.nav-wrap -->
        </div><!-- /.header-wrap -->
      </div><!-- /.col-md-12 -->
    </div><!-- /.row -->
  </div><!-- /.container-fluid -->
  <nav id="mainnav-mobi" class="mainnav" style="display: none">
    <ul class="menu">
      <li>
        <a href="/spaces" title="">Explore</a>
      </li>
      <% if user_signed_in? %>
      <% if host_route? %>
      <li>
        <%= link_to 'Bookings', host_bookings_path %>
      </li>
      <li>
        <%= link_to 'My Spaces', host_spaces_path %>
      </li>
      <% else %>
      <li>
        <%= link_to 'Trips', bookings_path %>
      </li>
      <li>
        <%= link_to 'Favorites', favorites_path %>
      </li>
      <li>
        <%= link_to 'Messages', conversations_path, id: 'conversation-button' %> <span class="btn-submenu"></span>
        <ul class="submenu" style="display: none;">
          <% current_user.conversations.each do |conversation| %>
          <li>
            <%= link_to conversation_path(conversation) do %>
            <%= conversation.last_message(current_user).try(:content) %>
            -
            <%= conversation.partner(current_user).try(:full_name) %>
            <% end %>
          </li>
          <% end %>
        </ul>
      </li>
      <% end %>
      <li>
        <%= link_to "Host", host_bookings_path %> <span class="btn-submenu"></span>
        <ul class="submenu" style="display: none;">
          <% if current_user.is_host? %>
          <li>
            <%= link_to "Bookings", host_bookings_path %>
          </li>
          <% end %>
          <li>
            <%= link_to "Log out", destroy_user_session_path, method: :delete %>
          </li>
        </ul>
      </li>
      <% else %>
      <li>
        <%= link_to 'Log in', new_user_session_path %>
      </li>
      <% end %>
    </ul>
  </nav>
</div><!-- /.header -->


